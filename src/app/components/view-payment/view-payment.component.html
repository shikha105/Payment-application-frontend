<div>
  <mat-card appearance="outlined">
    <mat-card-content>Total Due Amount: {{ totalDue }}</mat-card-content>
  </mat-card>
</div>

<mat-form-field>
  <input matInput (keyup)="applyFilter($event)" placeholder="filter" />
</mat-form-field>

<div class="container">
  <h2>Payment Details</h2>

  <table matSort mat-table [dataSource]="payments" class="mat-elevation-z8">
    <ng-container matColumnDef="payee_first_name">
      <th matSortHeader mat-header-cell *matHeaderCellDef>First Name</th>
      <td mat-cell *matCellDef="let payment">
        {{ payment.payee_first_name }}
      </td>
    </ng-container>

    <ng-container matColumnDef="payee_last_name">
      <th mat-header-cell *matHeaderCellDef>Last Name</th>
      <td mat-cell *matCellDef="let payment">
        {{ payment.payee_last_name }}
      </td>
    </ng-container>
    <ng-container matColumnDef="payee_due_date">
      <th mat-header-cell *matHeaderCellDef>Due Date</th>
      <td mat-cell *matCellDef="let payment">
        {{ payment.payee_due_date }}
      </td>
    </ng-container>

    <ng-container matColumnDef="due_amount">
      <th mat-header-cell *matHeaderCellDef>Due Amount</th>
      <td mat-cell *matCellDef="let payment">
        {{ payment.due_amount }}
      </td>
    </ng-container>
    <ng-container matColumnDef="payee_payment_status">
      <th mat-header-cell *matHeaderCellDef>Payment Status</th>
      <td mat-cell *matCellDef="let payment">
        {{ payment.payee_payment_status }}
      </td>
    </ng-container>

    <ng-container matColumnDef="payee_address_line_1">
      <th mat-header-cell *matHeaderCellDef>Address Line 1</th>
      <td mat-cell *matCellDef="let payment">
        {{ payment.payee_address_line_1 }}
      </td>
    </ng-container>
    <ng-container matColumnDef="payee_address_line_2">
      <th mat-header-cell *matHeaderCellDef>Address Line 2</th>
      <td mat-cell *matCellDef="let payment">
        {{ payment.payee_address_line_1 }}
      </td>
    </ng-container>
    <ng-container matColumnDef="payee_city">
      <th mat-header-cell *matHeaderCellDef>City</th>
      <td mat-cell *matCellDef="let payment">
        {{ payment.payee_city }}
      </td>
    </ng-container>
    <ng-container matColumnDef="payee_country">
      <th mat-header-cell *matHeaderCellDef>Country</th>
      <td mat-cell *matCellDef="let payment">
        {{ payment.payee_country }}
      </td>
    </ng-container>

    <ng-container matColumnDef="payee_postal_code">
      <th mat-header-cell *matHeaderCellDef>Postal Code</th>
      <td mat-cell *matCellDef="let payment">
        {{ payment.payee_postal_code }}
      </td>
    </ng-container>

    <ng-container matColumnDef="payee_phone_number">
      <th mat-header-cell *matHeaderCellDef>Phone Number</th>
      <td mat-cell *matCellDef="let payment">
        {{ payment.payee_phone_number }}
      </td>
    </ng-container>
    <ng-container matColumnDef="payee_email">
      <th mat-header-cell *matHeaderCellDef>Email</th>
      <td mat-cell *matCellDef="let payment">
        {{ payment.payee_email }}
      </td>
    </ng-container>
    <ng-container matColumnDef="currency">
      <th mat-header-cell *matHeaderCellDef>Currency</th>
      <td mat-cell *matCellDef="let payment">
        {{ payment.currency }}
      </td>
    </ng-container>
    <ng-container matColumnDef="actions">
      <th mat-header-cell *matHeaderCellDef>Actions</th>
      <td mat-cell *matCellDef="let payment">
        <button mat-button color="primary">
          <a
            [routerLink]="['/edit-payment', payment._id]"
            routerLinkActive="active"
            ariaCurrentWhenActive="page"
            >Edit payment</a
          >
        </button>
        <button mat-button color="warn" (click)="onDelete(payment._id)">
          Delete payment
        </button>

        <button
          *ngIf="payment?.evidence_id !== null"
          mat-button
          color="accent"
          (click)="downloadEvidence(payment._id)"
        >
          Download Evidence
        </button>
      </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
  </table>
</div>

<div class="add-payment-link">
  <a
    routerLink="/add-payment"
    routerLinkActive="active"
    ariaCurrentWhenActive="page"
    >Add new payment</a
  >
</div>
